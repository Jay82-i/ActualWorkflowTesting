Improve validation, error handling, and edge cases
